<!DOCTYPE html>
<html>
<head>
    <title>ESP32 Firebase Control</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBaAtipE9V2o-JTIfknqrHIufenAAkZir4",
            authDomain: "madpro-ed9c6.firebaseapp.com",
            projectId: "madpro-ed9c6",
            databaseURL: "https://madpro-ed9c6-default-rtdb.firebaseio.com", // Check your console for this URL
            storageBucket: "madpro-ed9c6.firebasestorage.app",
            messagingSenderId: "845190940074",
            appId: "1:845190940074:web:e8ebfb3061e9c89c6e97d3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const ledRef = ref(db, 'led_status');

        // Sync button UI with Database
        onValue(ledRef, (snapshot) => {
            const val = snapshot.val();
            const btn = document.getElementById("btn");
            btn.innerText = val === 1 ? "TURN OFF" : "TURN ON";
            btn.style.backgroundColor = val === 1 ? "#dc3545" : "#28a745";
            window.currentStatus = val;
        });

        // Function to toggle
        window.toggleLED = function() {
            const nextStatus = window.currentStatus === 1 ? 0 : 1;
            set(ledRef, nextStatus);
        };
    </script>
</head>
<body style="text-align:center; padding-top:50px; font-family:sans-serif;">
    <h1>Firebase LED Control</h1>
    <button id="btn" onclick="toggleLED()" style="padding:20px 40px; color:white; border:none; border-radius:8px; cursor:pointer;">Loading...</button>
</body>
</html>
